<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coupon Management</title>
    <link rel="icon" type="image/png"
        href="https://res.cloudinary.com/dghzlcoco/image/upload/v1743229133/letter-l-cool-logo-icon-design_1122425-152_kouse3.jpg">
    <link rel="stylesheet" href="/static/css/font_style.css" type="text/css" />
    <link rel="stylesheet" href="/static/css/toast.css" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/static/js/nav&sideBar.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"></script>
    <style>
        .modal {
            transition: opacity 0.25s ease;
        }

        body.modal-active {
            overflow-x: hidden;
            overflow-y: visible !important;
        }

        .opacity-95 {
            opacity: 0.95;
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col lg:flex-row">
    <!-- Sidebar -->
    <aside id="sidebar"
        class="lg:block hidden w-full lg:w-64 bg-black text-white flex flex-col sticky top-0 lg:h-screen z-50 ">
        <div class="py-6 px-4 flex items-center justify-start space-x-4">
            <!-- Hamburger Menu for Small Screens inside Sidebar -->
            <button class="lg:hidden text-white" onclick="toggleSidebar()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            <!-- Logo -->
            <h1 class="text-4xl font-bold tracking-wide logo-font">LAPTIX</h1>
        </div>
        <nav class="flex-1 ">
            <ul>
                <li class="py-3 px-4 flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M13 9V3h8v6zM3 13V3h8v10zm10 8V11h8v10zM3 21v-6h8v6zm2-10h4V5H5zm10 8h4v-6h-4zm0-12h4V5h-4zM5 19h4v-2H5zm4-2" />
                    </svg>
                    <a href="/admin/dashboard" class="text-base font-medium hover:text-blue-500">Dashboard</a>
                </li>
                <li class="py-3 px-4  flex items-center space-x-2">
                    <!-- All Products Button with Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 512 512"
                        fill="currentColour">
                        <rect width="384" height="256" x="64" y="176" fill="none" stroke="currentColor"
                            stroke-linejoin="round" stroke-width="32" rx="28.87" ry="28.87" />
                        <path fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10"
                            stroke-width="32" d="M144 80h224m-256 48h288" />
                    </svg>
                    <a href="/admin/products" class="text-base font-medium  ">All Products</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor" fill-rule="evenodd"
                            d="M14.25 2.5a.25.25 0 0 0-.25-.25H7A2.75 2.75 0 0 0 4.25 5v14A2.75 2.75 0 0 0 7 21.75h10A2.75 2.75 0 0 0 19.75 19V9.147a.25.25 0 0 0-.25-.25H15a.75.75 0 0 1-.75-.75zm.75 9.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1 0-1.5zm0 4a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1 0-1.5z"
                            clip-rule="evenodd" />
                        <path fill="currentColor"
                            d="M15.75 2.824c0-.184.193-.301.336-.186q.182.147.323.342l3.013 4.197c.068.096-.006.22-.124.22H16a.25.25 0 0 1-.25-.25z" />
                    </svg>
                    <a href="/admin/orderlist" class="text-base font-medium hover:text-blue-500">Order List</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor"
                            d="M12 12.75c3.942 0 7.987 2.563 8.249 7.712a.75.75 0 0 1-.71.787c-2.08.106-11.713.171-15.077 0a.75.75 0 0 1-.711-.787C4.013 15.314 8.058 12.75 12 12.75m0-9a3.75 3.75 0 1 0 0 7.5a3.75 3.75 0 0 0 0-7.5" />
                    </svg>
                    <a href="/admin/users" class="text-base font-medium hover:text-blue-500">User Management</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="mr-2">
                        <path fill="currentColor"
                            d="M10 3H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1M9 9H5V5h4zm11-6h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1m-1 6h-4V5h4zm-9 4H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1m-1 6H5v-4h4zm8-6c-2.206 0-4 1.794-4 4s1.794 4 4 4s4-1.794 4-4s-1.794-4-4-4m0 6c-1.103 0-2-.897-2-2s.897-2 2-2s2 .897 2 2s-.897 2-2 2" />
                    </svg>
                    <a href="/admin/category" class="text-base font-medium hover:text-blue-500">Category Management</a>
                </li>
                <li class="py-3 px-4 bg-blue-600 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="mr-2">
                        <path fill="black"
                            d="M14.8 8L16 9.2L9.2 16L8 14.8zM4 4h16c1.11 0 2 .89 2 2v4a2 2 0 1 0 0 4v4c0 1.11-.89 2-2 2H4a2 2 0 0 1-2-2v-4c1.11 0 2-.89 2-2a2 2 0 0 0-2-2V6a2 2 0 0 1 2-2m0 2v2.54a3.994 3.994 0 0 1 0 6.92V18h16v-2.54a3.994 3.994 0 0 1 0-6.92V6zm5.5 2c.83 0 1.5.67 1.5 1.5S10.33 11 9.5 11S8 10.33 8 9.5S8.67 8 9.5 8m5 5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5" />
                    </svg>
                    <a href="/admin/coupon" class="text-base font-medium text-black">Coupon Management</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M21 6h-2V4a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2ZM5 4h12v2H5V4Zm16 16H5V8h16v12Zm-4-7a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z" />
                    </svg>
                    <a href="/admin/wallet/management" class="text-base font-medium hover:text-blue-500 pl-2">Wallet
                        Management</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" class="mr-2">
                        <path fill="currentColor"
                            d="M30 6V4h-3V2h-2v2h-1c-1.103 0-2 .898-2 2v2c0 1.103.897 2 2 2h4v2h-6v2h3v2h2v-2h1c1.103 0 2-.897 2-2v-2c0-1.102-.897-2-2-2h-4V6zm-6 14v2h2.586L23 25.586l-2.292-2.293a1 1 0 0 0-.706-.293H20a1 1 0 0 0-.706.293L14 28.586L15.414 30l4.587-4.586l2.292 2.293a1 1 0 0 0 1.414 0L28 23.414V26h2v-6zM4 30H2v-5c0-3.86 3.14-7 7-7h6c1.989 0 3.89.85 5.217 2.333l-1.49 1.334A5 5 0 0 0 15 20H9c-2.757 0-5 2.243-5 5zm8-14a7 7 0 1 0 0-14a7 7 0 0 0 0 14m0-12a5 5 0 1 1 0 10a5 5 0 0 1 0-10" />
                    </svg>
                    <a href="/sales" class="text-base font-medium hover:text-blue-500">Sales</a>
                </li>
                <li class="py-3 px-4 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="mr-2">
                        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                            stroke-width="1.5"
                            d="M7.05 6.462a2 2 0 0 0 2.63-1.519l.32-1.72a9 9 0 0 1 3.998 0l.322 1.72a2 2 0 0 0 2.63 1.519l1.649-.58a9 9 0 0 1 2.001 3.46l-1.33 1.14a2 2 0 0 0 0 3.037l1.33 1.139a9 9 0 0 1-2.001 3.46l-1.65-.58a2 2 0 0 0-2.63 1.519L14 20.777a9 9 0 0 1-3.998 0l-.322-1.72a2 2 0 0 0-2.63-1.519l-1.649.58a9 9 0 0 1-2.001-3.46l1.33-1.14a2 2 0 0 0 0-3.036L3.4 9.342a9 9 0 0 1 2-3.46zM12 9a3 3 0 1 1 0 6a3 3 0 0 1 0-6"
                            clip-rule="evenodd" />
                    </svg>
                    <a href="/admin/settings" class="text-base font-medium hover:text-blue-500">Settings</a>
                </li>
            </ul>
        </nav>
    </aside>
    <div class="toast-container z-40 fixed top-0 right-4">
        <div id="toast" class="z-40 toast bg-white shadow-lg rounded-lg p-4">
            <div class="toast-content flex items-center">
                <div class="toast-icon mr-2">
                    <i class="toast-icon-success fas fa-check-circle text-green-500 hidden"></i>
                    <i class="toast-icon-error fas fa-exclamation-circle text-red-500 hidden"></i>
                </div>
                <div class="toast-message text-gray-800">This is a toast message</div>
            </div>
            <div class="toast-progress h-1 bg-blue-500 mt-2"></div>
        </div>
    </div>
    <!-- Main Content -->
    <div class="flex-1 flex flex-col">
        <!-- Top Navigation -->
        <header class="bg-white shadow py-4 px-6 flex items-center sticky top-0 z-10 ">
            <!-- Hamburger Menu for Small Screens (Main Header) -->
            <button id="hamburger-menu" class="lg:hidden text-black mr-4" onclick="toggleSidebar()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            <!-- Logo -->
            <h1 class="text-2xl font-bold tracking-wide logo-font block lg:hidden">LAPTIX</h1>

            <div class="flex-grow lg:flex-grow-0"></div>
            <!-- Right-aligned buttons -->
            <div class="flex items-center space-x-4 ml-auto">
                <!-- Search Button -->
                <button id="search-button" onclick="toggleSearchBar()" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <g fill="none" fill-rule="evenodd">
                            <path
                                d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z" />
                            <path fill="bg-white"
                                d="M10.5 2a8.5 8.5 0 1 0 5.262 15.176l3.652 3.652a1 1 0 0 0 1.414-1.414l-3.652-3.652A8.5 8.5 0 0 0 10.5 2M4 10.5a6.5 6.5 0 1 1 13 0a6.5 6.5 0 0 1-13 0" />
                        </g>
                    </svg>
                </button>

                <!-- Search Bar Container -->
                <div id="search-bar-container"
                    class="hidden flex items-center border-2 border-blue-500 rounded-xl px-4 py-2 space-x-4">
                    <!-- Search Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" viewBox="0 0 20 20"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M12.9 14.32a8 8 0 1 1 1.414-1.415l4.387 4.387a1 1 0 01-1.414 1.415l-4.387-4.387zM14 8a6 6 0 11-12 0 6 6 0 0112 0z"
                            clip-rule="evenodd" />
                    </svg>

                    <!-- Input Field -->
                    <input id="search-input" type="text" placeholder="Search..."
                        class="outline-none bg-transparent text-lg" />
                    <!-- Clear Button -->
                    <button onclick="clearSearch()" class="text-blue-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
        </header>

        <div class="container mx-auto px-2 py-6 max-w-6xl">
            <!-- Content -->
            <main class="flex-1 overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">Coupon Management</h2>
                    <button
                        class="modal-open bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center">
                        <i data-feather="plus" class="h-5 w-5 mr-2"></i>
                        Add New Coupon
                    </button>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <div class="flex items-center">
                            <div class="bg-indigo-100 p-3 rounded-lg">
                                <i data-feather="tag" class="h-6 w-6 text-indigo-600"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-gray-500 text-sm font-medium">Active Coupons</h3>
                                <p class="text-2xl font-semibold text-gray-800">{{.Count}}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="mb-6 border-b border-gray-200">
                    <ul class="flex flex-wrap -mb-px">
                        <li class="mr-2">
                            <a href="#"
                                class="inline-block py-3 px-4 text-indigo-600 font-medium border-b-2 border-indigo-600">Active</a>
                        </li>
                    </ul>
                </div>

                <!-- Coupons Table -->
                <div class="bg-white rounded-lg shadow overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Coupon</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Type</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Value</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Applied To</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Usage / Limit</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Status</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell">
                                        Expiry</th>
                                    <th scope="col"
                                        class="px-3 sm:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                {{range .Coupons}}
                                <tr>
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="bg-indigo-100 p-2 rounded">
                                                <i data-feather="tag" class="h-4 w-4 text-indigo-600"></i>
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900">{{.CouponCode}}</div>
                                                <div class="text-sm text-gray-500">{{.Discription}}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <div class="text-sm text-gray-900">{{.CouponType}}</div>
                                    </td>
                                    {{if eq .CouponType "Percentage"}}
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <div class="text-sm text-gray-900">{{printf "%.2f" .DiscountValue}}%</div>
                                    </td>
                                    {{else}}
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <div class="text-sm text-gray-900">&#8377; {{printf "%.2f" .DiscountValue}}
                                        </div>
                                    </td>
                                    {{end}}
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <div class="text-sm text-gray-900">{{.ApplicableFor}}</div>
                                    </td>
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <div class="text-sm text-gray-900">{{.UsersUsedCount}} / {{.MaxUseCount}}</div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-indigo-600 h-2 rounded-full" style="width: 49%"></div>
                                        </div>
                                    </td>
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap hidden sm:table-cell">
                                        <span
                                            class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">{{.Status}}</span>
                                    </td>
                                    <td
                                        class="px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500 hidden sm:table-cell">
                                        <span class="format-date" data-date="{{.ExpirationDate}}"
                                            data-format="long"></span>
                                    </td>
                                    <td class="px-3 sm:px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <div class="flex justify-end space-x-2">
                                            <button class="text-indigo-600 hover:text-indigo-900 edit-coupon-btn"
                                                data-id="{{.ID}}">
                                                <i data-feather="edit-2" class="h-4 w-4"></i>
                                            </button>
                                            <form action="/admin/coupon/delete/{{.ID}}" method="post" class="inline">
                                                <button type="submit" class="text-red-600 hover:text-red-900">
                                                    <i data-feather="trash-2" class="h-4 w-4"></i>
                                                </button>
                                            </form>
                                        </div>
                                    </td>
                                </tr>
                                {{end}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </main>

            <!-- Modal -->
            <div
                class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
                <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>

                <div
                    class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-[90vh] sm:max-h-[85vh]">

                    <div class="modal-content py-4 text-left px-4 sm:px-6 max-h-[90vh] sm:max-h-[85vh] overflow-y-auto">
                        <!-- Title -->
                        <div class="flex justify-between items-center pb-3 border-b mb-6">
                            <p class="text-2xl font-bold text-gray-800 flex items-center">
                                <span class="bg-indigo-100 p-2 rounded-full mr-3">
                                    <i data-feather="tag" class="h-5 w-5 text-indigo-600"></i>
                                </span>
                                Add New Coupon
                            </p>
                            <div class="modal-close cursor-pointer z-50">
                                <i data-feather="x" class="h-6 w-6 text-gray-500 hover:text-gray-800"></i>
                            </div>
                        </div>

                        <!-- Form -->
                        <form onsubmit="return validateForm()">
                            <div class="space-y-6">
                                <!-- Basic Information -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Basic Information</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="coupon-code"
                                                class="block text-sm font-medium text-gray-700 mb-1">Coupon Code <span
                                                    class="text-red-500">*</span></label>
                                            <input type="text" id="coupon-code" name="coupon-code"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 placeholder-gray-400"
                                                placeholder="e.g. SUMMER20" required pattern="[A-Za-z]+[A-Za-z0-9]*"
                                                title="Coupon code must start with a letter and contain only letters and numbers">
                                        </div>
                                        <div>
                                            <label for="description"
                                                class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                            <input type="text" id="description" name="description"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 placeholder-gray-400"
                                                placeholder="e.g. Summer Sale">
                                        </div>
                                    </div>
                                </div>

                                <!-- Discount Type -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Discount Type & Value</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="type" class="block text-sm font-medium text-gray-700 mb-1">Type
                                                <span class="text-red-500">*</span></label>
                                            <select id="type" name="type"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                                <option value="" disabled selected>Select discount type</option>
                                                <option value="Percentage">Percentage</option>
                                                <option value="Fixed">Fixed Amount</option>
                                            </select>
                                        </div>

                                        <div id="value-field">
                                            <label for="value"
                                                class="block text-sm font-medium text-gray-700 mb-1">Value <span
                                                    class="text-red-500">*</span></label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm">%</span>
                                                </div>
                                                <input type="number" id="value" name="value" min="0"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 10" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Usage Restrictions -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Usage Restrictions</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="applied-to"
                                                class="block text-sm font-medium text-gray-700 mb-1">Applied To</label>
                                            <select id="applied-to" name="applied-to"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
                                                <option value="AllProducts">All Products</option>
                                                {{range .Category}}
                                                <option value="{{.Name}}">{{.Name}}</option>
                                                {{end}}
                                            </select>
                                        </div>

                                        <div>
                                            <label for="min-order"
                                                class="block text-sm font-medium text-gray-700 mb-1">Minimum Order
                                                Value</label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm">$</span>
                                                </div>
                                                <input type="number" id="min-order" name="min-order" min="0"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 50">
                                            </div>
                                        </div>

                                        <div>
                                            <label for="max-discount"
                                                class="block text-sm font-medium text-gray-700 mb-1">Maximum Discount
                                                Amount Value</label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm">$</span>
                                                </div>
                                                <input type="number" id="max-discount" name="max-discount" min="0"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 50">
                                            </div>
                                        </div>

                                        <div>
                                            <label for="usage-limit"
                                                class="block text-sm font-medium text-gray-700 mb-1">Usage Limit</label>
                                            <input type="number" id="usage-limit" name="usage-limit" min="0"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
                                        </div>
                                    </div>
                                </div>

                                <!-- Expiry -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Expiration</h3>
                                    <div>
                                        <div id="valid-date-field" class="mt-4">
                                            <label for="valid-date"
                                                class="block text-sm font-medium text-gray-700 mb-1">Valid From <span
                                                    class="text-red-500">*</span></label>
                                            <input type="date" id="valid-date" name="valid-date"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                        </div>

                                        <div id="expiry-date-field" class="mt-4">
                                            <label for="expiry-date"
                                                class="block text-sm font-medium text-gray-700 mb-1">Expiry Date <span
                                                    class="text-red-500">*</span></label>
                                            <input type="date" id="expiry-date" name="expiry-date"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Buttons -->
                            <div class="mt-8 flex justify-end space-x-3">
                                <button type="button"
                                    class="modal-close px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                                    Cancel
                                </button>
                                <button type="submit"
                                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400">
                                    Create Coupon
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div
                class="edit-modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
                <div class="edit-modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>

                <div
                    class="edit-modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-[90vh] sm:max-h-[85vh]">

                    <div
                        class="edit-modal-content py-4 text-left px-4 sm:px-6 max-h-[90vh] sm:max-h-[85vh] overflow-y-auto">
                        <!-- Title -->
                        <div class="flex justify-between items-center pb-3 border-b mb-6">
                            <p class="text-2xl font-bold text-gray-800 flex items-center">
                                <span class="bg-indigo-100 p-2 rounded-full mr-3">
                                    <i data-feather="tag" class="h-5 w-5 text-indigo-600"></i>
                                </span>
                                Update Coupon
                            </p>
                            <div class="edit-modal-close cursor-pointer z-50">
                                <i data-feather="x" class="h-6 w-6 text-gray-500 hover:text-gray-800"></i>
                            </div>
                        </div>

                        <!-- Form -->
                        <form id="edit-coupon-form">
                            <input type="hidden" id="edit-coupon-id" name="edit-coupon-id">
                            <div class="space-y-6">
                                <!-- Basic Information -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Basic Information</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="edit-coupon-code"
                                                class="block text-sm font-medium text-gray-700 mb-1">Coupon Code <span
                                                    class="text-red-500">*</span></label>
                                            <input type="text" id="edit-coupon-code" name="edit-coupon-code"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 placeholder-gray-400"
                                                placeholder="e.g. SUMMER20" required>
                                        </div>
                                        <div>
                                            <label for="edit-description"
                                                class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                            <input type="text" id="edit-description" name="edit-description"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 placeholder-gray-400"
                                                placeholder="e.g. Summer Sale">
                                        </div>
                                    </div>
                                </div>

                                <!-- Discount Type -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Discount Type & Value</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="edit-type"
                                                class="block text-sm font-medium text-gray-700 mb-1">Type
                                                <span class="text-red-500">*</span></label>
                                            <select id="edit-type" name="edit-type"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                                <option value="" disabled>Select discount type</option>
                                                <option value="Percentage">Percentage</option>
                                                <option value="Fixed">Fixed Amount</option>
                                            </select>
                                        </div>

                                        <div id="edit-value-field">
                                            <label for="edit-value"
                                                class="block text-sm font-medium text-gray-700 mb-1">Value <span
                                                    class="text-red-500">*</span></label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm"
                                                        id="edit-value-prefix">%</span>
                                                </div>
                                                <input type="number" id="edit-value" name="edit-value"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 10" required>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Usage Restrictions -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Usage Restrictions</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="edit-applied-to"
                                                class="block text-sm font-medium text-gray-700 mb-1">Applied To</label>
                                            <select id="edit-applied-to" name="edit-applied-to"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400">
                                                <option value="AllProducts">All Products</option>
                                                {{range .Category}}
                                                <option value="{{.Name}}">{{.Name}}</option>
                                                {{end}}
                                            </select>
                                        </div>

                                        <div>
                                            <label for="edit-min-order"
                                                class="block text-sm font-medium text-gray-700 mb-1">Minimum Order
                                                Value</label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm">$</span>
                                                </div>
                                                <input type="number" id="edit-min-order" name="edit-min-order"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 50">
                                            </div>
                                        </div>

                                        <div>
                                            <label for="edit-max-discount"
                                                class="block text-sm font-medium text-gray-700 mb-1">Maximum Discount
                                                Amount
                                                Value</label>
                                            <div class="relative">
                                                <div
                                                    class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                    <span class="text-gray-500 sm:text-sm">$</span>
                                                </div>
                                                <input type="number" id="edit-max-discount" name="edit-max-discount"
                                                    class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    placeholder="e.g. 50">
                                            </div>
                                        </div>

                                        <div>
                                            <label for="edit-usage-limit"
                                                class="block text-sm font-medium text-gray-700 mb-1">Usage Limit</label>
                                            <input type="number" id="edit-usage-limit" name="edit-usage-limit"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                placeholder="Leave empty for unlimited">
                                            <p class="mt-1 text-xs text-gray-500">Leave empty for unlimited usage</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Expiry -->
                                <div>
                                    <h3 class="text-lg font-medium text-gray-800 mb-4">Expiration</h3>
                                    <div>
                                        <div id="edit-valid-date-field" class="mt-4">
                                            <label for="edit-valid-date"
                                                class="block text-sm font-medium text-gray-700 mb-1">Valid From <span
                                                    class="text-red-500">*</span></label>
                                            <input type="date" id="edit-valid-date" name="edit-valid-date"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                        </div>

                                        <div id="edit-expiry-date-field" class="mt-4">
                                            <label for="edit-expiry-date"
                                                class="block text-sm font-medium text-gray-700 mb-1">Expiry Date <span
                                                    class="text-red-500">*</span></label>
                                            <input type="date" id="edit-expiry-date" name="edit-expiry-date"
                                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                required>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Buttons -->
                            <div class="mt-8 flex justify-end space-x-3">
                                <button type="button"
                                    class="edit-modal-close px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                                    Cancel
                                </button>
                                <button type="submit"
                                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-400">
                                    Update Coupon
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Feather icons for any newly added elements
            feather.replace();

            // Edit Modal functionality
            const editButtons = document.querySelectorAll('.edit-coupon-btn');
            const editCloseButtons = document.querySelectorAll('.edit-modal-close');
            const editModal = document.querySelector('.edit-modal');
            const editOverlay = document.querySelector('.edit-modal-overlay');

            // Add event listeners to edit buttons
            editButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const couponId = e.currentTarget.getAttribute('data-id');
                    fetchCouponDetails(couponId);
                });
            });

            // Add event listeners to close buttons
            editCloseButtons.forEach(button => {
                button.addEventListener('click', closeEditModal);
            });

            if (editOverlay) {
                editOverlay.addEventListener('click', closeEditModal);
            }

            // Discount type change handler for edit form
            const editTypeSelect = document.getElementById('edit-type');
            const editValueField = document.getElementById('edit-value-field');
            const editValuePrefix = document.getElementById('edit-value-prefix');

            if (editTypeSelect) {
                editTypeSelect.addEventListener('change', function () {
                    if (this.value === 'shipping') {
                        editValueField.style.display = 'none';
                    } else {
                        editValueField.style.display = 'block';

                        // Update prefix based on type
                        if (this.value === 'Percentage') {
                            editValuePrefix.textContent = '%';
                        } else if (this.value === 'Fixed') {
                            editValuePrefix.textContent = '$';
                        }
                    }
                });
            }

            // Function to fetch coupon details
            function fetchCouponDetails(couponId) {
                fetch(`/admin/coupon/details/${couponId}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Failed to fetch coupon details');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log("Received data:", data);
                        if (data && data.coupon) {
                            console.log("Coupon data:", data.coupon);
                            populateEditForm(data.coupon);
                            openEditModal();
                        } else {
                            throw new Error('Invalid coupon data received');
                        }
                    })
                    .catch(error => {
                        showErrorToast(error.message || 'Failed to load coupon details');
                        console.error('Error:', error);
                    });
            }

            // Function to populate edit form with fetched data
            function populateEditForm(couponData) {
                document.getElementById('edit-coupon-id').value = couponData.ID;
                document.getElementById('edit-coupon-code').value = couponData.code || couponData.CouponCode;
                document.getElementById('edit-description').value = couponData.Discription || '';

                const typeSelect = document.getElementById('edit-type');
                typeSelect.value = couponData.CouponType || 'Percentage';

                // Trigger change event to update the value field prefix
                const changeEvent = new Event('change');
                typeSelect.dispatchEvent(changeEvent);

                document.getElementById('edit-value').value = couponData.discount_value || 0;

                const appliedToSelect = document.getElementById('edit-applied-to');
                appliedToSelect.value = couponData.applicable || couponData.ApplicableFor || 'AllProducts';

                document.getElementById('edit-min-order').value = couponData.min_productvalue || couponData.MinOrdervalue || '';
                document.getElementById('edit-max-discount').value = couponData.max_value || couponData.MaxDiscountValue || '';
                document.getElementById('edit-usage-limit').value = couponData.max_use_count || couponData.MaxUseCount || '';

                // Format dates for input date fields (YYYY-MM-DD)
                if (couponData.validfrom || couponData.ValidFrom) {
                    document.getElementById('edit-valid-date').value = formatDateForInput(couponData.validfrom || couponData.ValidFrom);
                }

                if (couponData.validto || couponData.ExpirationDate) {
                    document.getElementById('edit-expiry-date').value = formatDateForInput(couponData.validto || couponData.ExpirationDate);
                }
            }

            // Helper function to format date for input fields
            function formatDateForInput(dateString) {
                const date = new Date(dateString);
                return date.toISOString().split('T')[0];
            }

            // Function to open edit modal
            function openEditModal() {
                if (editModal) {
                    editModal.classList.remove('opacity-0');
                    editModal.classList.remove('pointer-events-none');
                    document.body.classList.add('modal-active');

                    // Re-initialize Feather icons for modal content
                    feather.replace();
                }
            }

            // Function to close edit modal
            function closeEditModal() {
                if (editModal) {
                    editModal.classList.add('opacity-0');
                    editModal.classList.add('pointer-events-none');
                    document.body.classList.remove('modal-active');
                }
            }

            // Handle edit form submission
            const editCouponForm = document.getElementById('edit-coupon-form');
            if (editCouponForm) {
                editCouponForm.addEventListener('submit', function (event) {
                    event.preventDefault();

                    // Gather form data
                    const formData = new FormData(this);
                    const couponId = formData.get('edit-coupon-id');

                    const couponData = {
                        id: couponId,
                        code: formData.get('edit-coupon-code'),
                        description: formData.get('edit-description'),
                        type: formData.get('edit-type'),
                        value: formData.get('edit-value'),
                        appliedTo: formData.get('edit-applied-to'),
                        minOrderValue: formData.get('edit-min-order'),
                        maxDiscount: formData.get('edit-max-discount'),
                        usageLimit: formData.get('edit-usage-limit'),
                        validDate: formData.get('edit-valid-date'),
                        expiryDate: formData.get('edit-expiry-date')
                    };

                    // Show loading state
                    const submitButton = this.querySelector('button[type="submit"]');
                    const originalText = submitButton.textContent;
                    submitButton.textContent = 'Updating...';
                    submitButton.disabled = true;

                    // API call to update the coupon
                    fetch(`/admin/coupon/details/edit/${couponId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(couponData)
                    })
                        .then(response => {
                            if (!response.ok) {
                                return response.json().then(errData => {
                                    throw new Error(errData.message || 'Something went wrong');
                                });
                            }
                            return response.json();
                        })
                        .then(data => {
                            // Show success toast with backend response
                            showSuccessToast(data.message || `Coupon "${couponData.code}" has been updated successfully.`);

                            // Close modal
                            closeEditModal();

                            // Refresh the page to show updated data
                            window.location.reload();
                        })
                        .catch(error => {
                            // Show error toast with backend response
                            showErrorToast(error.message || 'Failed to update coupon. Please try again.');
                            console.error('Error:', error);
                        })
                        .finally(() => {
                            // Reset button state
                            submitButton.textContent = originalText;
                            submitButton.disabled = false;
                        });
                });
            }
        });

        // Add edit button click handler to all edit buttons
        // This is outside the DOMContentLoaded event to ensure it catches dynamically added buttons
        function attachEditButtonHandlers() {
            const editButtons = document.querySelectorAll('.edit-coupon-btn');
            editButtons.forEach(button => {
                if (!button.hasAttribute('data-handler-attached')) {
                    button.setAttribute('data-handler-attached', 'true');
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        const couponId = e.currentTarget.getAttribute('data-id');
                        fetchCouponDetails(couponId);
                    });
                }
            });
        }

        // Call this function after page load and after any AJAX operations that might add new buttons
        document.addEventListener('DOMContentLoaded', attachEditButtonHandlers);


        // Initialize Feather icons
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();

            // Modal functionality
            const openButtons = document.querySelectorAll('.modal-open');
            const closeButtons = document.querySelectorAll('.modal-close');
            const modal = document.querySelector('.modal');
            const overlay = document.querySelector('.modal-overlay');

            // Add event listeners
            openButtons.forEach(button => {
                button.addEventListener('click', openModal);
            });

            closeButtons.forEach(button => {
                button.addEventListener('click', closeModal);
            });

            overlay.addEventListener('click', closeModal);

            // Discount type change handler
            const typeSelect = document.getElementById('type');
            const valueField = document.getElementById('value-field');

            typeSelect.addEventListener('change', function () {
                if (this.value === 'shipping') {
                    valueField.style.display = 'none';
                } else {
                    valueField.style.display = 'block';

                    // Update prefix based on type
                    const valueInput = document.getElementById('value');
                    const prefix = valueInput.previousElementSibling.querySelector('span');

                    if (this.value === 'percentage') {
                        prefix.textContent = '%';
                    } else if (this.value === 'fixed') {
                        prefix.textContent = '$';
                    }
                }
            });

            const expiryDateField = document.getElementById('expiry-date-field');
            const validDateField = document.getElementById('valid-date-field');
        });

        // Open modal function - moved outside the DOMContentLoaded event
        const openModal = () => {
            const modal = document.querySelector('.modal');
            modal.classList.remove('opacity-0');
            modal.classList.remove('pointer-events-none');
            document.body.classList.add('modal-active');
        };

        // Close modal function - moved outside the DOMContentLoaded event
        const closeModal = () => {
            const modal = document.querySelector('.modal');
            modal.classList.add('opacity-0');
            modal.classList.add('pointer-events-none');
            document.body.classList.remove('modal-active');
        };

        // Form submission handler
        const couponForm = document.querySelector('.modal-container form');

        couponForm.addEventListener('submit', function (event) {
            event.preventDefault();

            // Gather form data
            const formData = new FormData(this);
            const couponData = {
                code: formData.get('coupon-code'),
                description: formData.get('description'),
                type: formData.get('type'),
                value: formData.get('value'),
                appliedTo: formData.get('applied-to'),
                minOrderValue: formData.get('min-order'),
                maxDiscount: formData.get('max-discount'),
                usageLimit: formData.get('usage-limit'),
                expiryDate: formData.get('expiry-date'),
                validDate: formData.get('valid-date')
            };

            // Show loading state
            const submitButton = this.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;
            submitButton.textContent = 'Creating...';
            submitButton.disabled = true;

            // API call to save the coupon
            fetch('/admin/coupon/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(couponData)
            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(errData => {
                            throw new Error(errData.message || 'Something went wrong');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    // Show success toast with backend response
                    showSuccessToast(data.message || `Coupon "${couponData.code}" has been created successfully.`);
                    // Reset form
                    couponForm.reset();

                    // Close modal
                    closeModal();
                    // Refresh coupon list if it exists
                    if (typeof refreshCouponList === 'function') {
                        refreshCouponList();
                    }
                    window.location.reload();
                })
                .catch(error => {
                    // Show error toast with backend response
                    showErrorToast(error.message || 'Failed to create coupon. Please try again.');
                    console.error('Error:', error);
                })
                .finally(() => {
                    // Reset button state
                    submitButton.textContent = originalText;
                    submitButton.disabled = false;
                });
        });

        document.querySelectorAll('form[action^="/admin/coupon/delete/"]').forEach(form => {
            form.addEventListener('submit', function (e) {
                e.preventDefault();

                // Submit the form via AJAX
                fetch(this.action, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    }
                })
                    .then(response => {
                        if (response.ok) {
                            // Show success toast and remove the row from the UI
                            showSuccessToast('Coupon deleted successfully');
                            this.closest('tr').remove(); // Remove the row from the table
                        } else {
                            // Show error toast
                            showErrorToast('Failed to delete coupon');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showErrorToast('An error occurred');
                    });
            });
        });
        function validateForm() {
            // Coupon code validation is handled by HTML pattern

            // Value validation based on discount type
            const discountType = document.getElementById('type').value;
            const value = document.getElementById('value').value;

            if (discountType === 'Percentage' && value > 90) {
                return false;
            }

            // Date validation
            const validDate = new Date(document.getElementById('valid-date').value);
            const expiryDate = new Date(document.getElementById('expiry-date').value);

            if (validDate > expiryDate) {
                alert('Valid From date cannot be later than Expiry Date');
                return false;
            }

            return true;
        }
    </script>
    <script src="/static/js/toastMain.js"></script>
    <script src="/static/js/formatDate.js"></script>
</body>

</html>